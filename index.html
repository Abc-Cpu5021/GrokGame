<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BrainRot Draw - Single Player</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0015;
      --accent: #00ff9d;
      --pink: #ff00aa;
      --purple: #9d00ff;
      --text: #f0f0ff;
      --card: rgba(20, 10, 40, 0.75);
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background: linear-gradient(135deg, var(--bg), #120025);
      color: var(--text);
      font-family: 'Orbitron', sans-serif;
      min-height: 100vh;
      overflow: hidden;
    }
    .screen { 
      position: fixed; inset: 0; 
      display: none; flex-direction: column; 
      align-items: center; justify-content: center; 
      padding: 20px; backdrop-filter: blur(12px); 
      background: rgba(10,5,20,0.65);
    }
    .screen.active { display: flex; }
    h1 {
      font-size: clamp(2.5rem, 9vw, 5rem);
      background: linear-gradient(90deg, var(--pink), var(--accent), #00aaff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 1rem;
      text-shadow: 0 0 25px rgba(0,255,157,0.5);
    }
    .btn {
      padding: 12px 32px;
      font-size: 1.1rem;
      font-weight: 700;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.25s;
      box-shadow: 0 6px 20px rgba(0,0,0,0.5);
      margin: 10px;
    }
    .btn-primary  { background: linear-gradient(45deg, var(--accent), #00d4ff); color:#000; }
    .btn-secondary{ background: linear-gradient(45deg, var(--purple), var(--pink)); color:white; }
    .btn-danger   { background: linear-gradient(45deg, #ff3366, #ff6b6b); }
    .btn:hover    { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,255,157,0.35); }

    input, select {
      padding: 12px 20px;
      font-size: 1rem;
      border: 2px solid var(--accent);
      border-radius: 50px;
      background: rgba(255,255,255,0.08);
      color: white;
      width: 240px;
      max-width: 90vw;
      text-align: center;
    }

    .card {
      background: var(--card);
      border-radius: 18px;
      padding: 20px 24px;
      width: min(90vw, 420px);
      border: 1px solid rgba(0,255,157,0.2);
      box-shadow: 0 8px 30px rgba(0,0,0,0.5);
    }

    #drawingCanvas {
      width: min(90vw, 640px);
      height: min(50vh, 640px);
      border: 4px solid var(--accent);
      border-radius: 12px;
      box-shadow: 0 0 45px rgba(0,255,157,0.3);
      background: white url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect width="40" height="40" fill="%23f9f9f9"/><path d="M0 20h40M20 0v40" stroke="%23e8e8e8" stroke-width="1"/></svg>') repeat;
      touch-action: none;
    }

    .tools-bar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 18px;
      background: var(--card);
      padding: 16px 20px;
      border-radius: 20px;
      border: 1px solid rgba(0,255,157,0.15);
      margin: 16px 0;
    }
    .tool-group { display: flex; flex-direction: column; align-items: center; gap: 6px; min-width: 90px; }
    .tool-btn {
      width: 56px; height: 56px;
      border-radius: 50%;
      font-size: 1.6rem;
      border: none;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4);
      transition: all 0.2s;
    }
    .tool-btn.active { transform: scale(1.1); box-shadow: 0 0 25px var(--accent); }

    #timer {
      font-size: clamp(2.5rem, 8vw, 5rem);
      font-weight: 900;
      color: var(--accent);
      text-shadow: 0 0 30px var(--accent);
      margin: 0.6rem 0;
    }

    #status {
      position: fixed; bottom: 16px; left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      padding: 10px 22px;
      border-radius: 50px;
      font-size: 1rem;
      z-index: 999;
      border: 1px solid rgba(0,255,157,0.25);
    }

    @media (max-width: 600px) {
      .tools-bar { flex-direction: column; gap: 14px; }
    }
  </style>
</head>
<body>

<div id="menu" class="screen active">
  <h1>üß† BRAINROT DRAW</h1>
  <div class="card">
    <p style="text-align:center; margin-bottom:1.2rem;">
      Your Stars: <strong id="totalStars">0</strong> ‚≠ê
    </p>
    <button id="startGame" class="btn btn-primary">Start Drawing!</button>
  </div>
</div>

<div id="drawingScreen" class="screen">
  <h1>Draw This Brainrot!</h1>
  <div id="timer">03:00</div>

  <div style="flex:1; width:100%; display:flex; flex-direction:column; align-items:center; gap:14px; padding:14px;">
    <div class="tools-bar">
      <div class="tool-group">
        <button id="pencilBtn" class="tool-btn active">‚úèÔ∏è</button>
        <label>Size</label>
        <input id="pencilSize" type="range" min="2" max="60" value="6"/>
        <span id="pencilSizeVal">6</span>
      </div>
      <div class="tool-group">
        <button id="eraserBtn" class="tool-btn">üßº</button>
        <label>Size</label>
        <input id="eraserSize" type="range" min="8" max="120" value="24"/>
        <span id="eraserSizeVal">24</span>
      </div>
      <div class="tool-group">
        <input id="colorPicker" type="color" value="#000000"/>
        <span>Color</span>
      </div>
      <button id="clearCanvas" class="btn btn-secondary">Clear</button>
    </div>

    <canvas id="drawingCanvas"></canvas>
    <img id="refImg" style="max-width:80vw; max-height:28vh; border-radius:10px; box-shadow:0 0 35px #ff00aa; display:none;"/>
  </div>

  <button id="finishDrawing" class="btn btn-primary" style="margin:1rem;">I'm Done!</button>
</div>

<div id="ratingScreen" class="screen">
  <h1>Rate Your Masterpiece</h1>
  <div style="text-align:center; margin:1rem 0;">
    <img id="finalDrawing" style="max-width:70vw; max-height:40vh; border:3px solid var(--accent); border-radius:12px; background:white;"/>
  </div>
  <div class="stars" id="selfRating">
    <span class="star">‚òÖ</span><span class="star">‚òÖ</span><span class="star">‚òÖ</span><span class="star">‚òÖ</span><span class="star">‚òÖ</span>
  </div>
  <button id="submitRating" class="btn btn-primary" style="margin-top:1.5rem;">Save Rating</button>
</div>

<div id="status">Ready</div>

<script>
// ‚îÄ‚îÄ‚îÄ State ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let totalStars = parseInt(localStorage.getItem('br_stars') || '0');
let canvas, ctx, isDrawing = false, tool = 'pencil', lastX, lastY;
let timerInterval = null;
let currentRating = 0;

const els = {
  totalStars: document.getElementById('totalStars'),
  startGame: document.getElementById('startGame'),
  timer: document.getElementById('timer'),
  drawingCanvas: document.getElementById('drawingCanvas'),
  refImg: document.getElementById('refImg'),
  pencilBtn: document.getElementById('pencilBtn'),
  eraserBtn: document.getElementById('eraserBtn'),
  pencilSize: document.getElementById('pencilSize'),
  eraserSize: document.getElementById('eraserSize'),
  pencilSizeVal: document.getElementById('pencilSizeVal'),
  eraserSizeVal: document.getElementById('eraserSizeVal'),
  colorPicker: document.getElementById('colorPicker'),
  clearCanvas: document.getElementById('clearCanvas'),
  finishDrawing: document.getElementById('finishDrawing'),
  finalDrawing: document.getElementById('finalDrawing'),
  selfRating: document.getElementById('selfRating'),
  submitRating: document.getElementById('submitRating'),
  status: document.getElementById('status')
};

els.totalStars.textContent = totalStars;

// ‚îÄ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function setStatus(msg) {
  els.status.textContent = msg;
}

// ‚îÄ‚îÄ‚îÄ Canvas ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function initCanvas() {
  canvas = els.drawingCanvas;
  ctx = canvas.getContext('2d');
  canvas.width = canvas.offsetWidth;
  canvas.height = canvas.offsetHeight;
  ctx.fillStyle = 'white';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';

  const getPos = e => {
    const r = canvas.getBoundingClientRect();
    return {
      x: ((e.touches?.[0]?.clientX ?? e.clientX) - r.left) * (canvas.width / r.width),
      y: ((e.touches?.[0]?.clientY ?? e.clientY) - r.top) * (canvas.height / r.height)
    };
  };

  const draw = (x, y, force = false) => {
    if (!isDrawing && !force) return;
    ctx.lineWidth = tool === 'pencil' ? +els.pencilSize.value : +els.eraserSize.value;
    ctx.globalCompositeOperation = tool === 'eraser' ? 'destination-out' : 'source-over';
    if (tool === 'pencil') ctx.strokeStyle = els.colorPicker.value;
    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
    ctx.lineTo(x, y);
    ctx.stroke();
    lastX = x; lastY = y;
  };

  const down = e => { e.preventDefault(); isDrawing = true; const p = getPos(e); lastX = p.x; lastY = p.y; draw(p.x, p.y, true); };
  const move = e => { e.preventDefault(); if (!isDrawing) return; const p = getPos(e); draw(p.x, p.y); };
  const up   = () => isDrawing = false;

  canvas.addEventListener('mousedown', down);
  canvas.addEventListener('mousemove', move);
  canvas.addEventListener('mouseup', up);
  canvas.addEventListener('mouseout', up);
  canvas.addEventListener('touchstart', down);
  canvas.addEventListener('touchmove', move);
  canvas.addEventListener('touchend', up);
}

// ‚îÄ‚îÄ‚îÄ Tool events ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
els.pencilBtn.onclick = () => { tool = 'pencil'; els.pencilBtn.classList.add('active'); els.eraserBtn.classList.remove('active'); };
els.eraserBtn.onclick = () => { tool = 'eraser'; els.eraserBtn.classList.add('active'); els.pencilBtn.classList.remove('active'); };
els.pencilSize.oninput = () => els.pencilSizeVal.textContent = els.pencilSize.value;
els.eraserSize.oninput = () => els.eraserSizeVal.textContent = els.eraserSize.value;
els.clearCanvas.onclick = () => {
  ctx.fillStyle = 'white';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
};

// ‚îÄ‚îÄ‚îÄ Game flow ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const brainrotImgs = [
  'https://i.imgflip.com/9zxkqn.jpg',
  'https://i.imgflip.com/9dv4gr.jpg',
  'https://media.tenor.com/Ze4VJGFRfZcAAAAe/skibidi-toilet-brainrot.png',
  'https://i.pinimg.com/originals/fb/fd/39/fbfd3906510504974f2a7280d81cd536.jpg'
];

els.startGame.onclick = () => {
  const idx = Math.floor(Math.random() * brainrotImgs.length);
  els.refImg.src = brainrotImgs[idx];
  els.refImg.style.display = 'block';
  showScreen('drawingScreen');
  initCanvas();
  startTimer();
};

function startTimer() {
  if (timerInterval) clearInterval(timerInterval);
  let remaining = 180;
  els.timer.textContent = '03:00';

  timerInterval = setInterval(() => {
    remaining--;
    if (remaining <= 0) {
      clearInterval(timerInterval);
      els.timer.textContent = '00:00';
      els.finishDrawing.textContent = "Time's Up! Finish";
      return;
    }
    const m = Math.floor(remaining / 60).toString().padStart(2, '0');
    const s = (remaining % 60).toString().padStart(2, '0');
    els.timer.textContent = `${m}:${s}`;
  }, 1000);
}

els.finishDrawing.onclick = () => {
  if (timerInterval) clearInterval(timerInterval);
  const dataUrl = canvas.toDataURL('image/png');
  els.finalDrawing.src = dataUrl;
  showScreen('ratingScreen');
};

els.selfRating.onclick = e => {
  if (e.target.tagName !== 'SPAN') return;
  const idx = Array.from(els.selfRating.children).indexOf(e.target);
  Array.from(els.selfRating.children).forEach((s, i) => {
    s.classList.toggle('active', i <= idx);
  });
  currentRating = idx + 1;
};

els.submitRating.onclick = () => {
  if (currentRating === 0) return alert("Give at least 1 star!");
  totalStars += currentRating;
  els.totalStars.textContent = totalStars;
  localStorage.setItem('br_stars', totalStars);
  setStatus(`+${currentRating} stars! Total: ${totalStars}`);
  setTimeout(() => showScreen('menu'), 1800);
};

// Resize handling
window.addEventListener('resize', () => {
  if (canvas && ctx && document.getElementById('drawingScreen').classList.contains('active')) {
    const data = canvas.toDataURL();
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    const img = new Image();
    img.src = data;
    img.onload = () => ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  }
});
  </script>
</body>
</html>
